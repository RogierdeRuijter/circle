<html lang="en">
<head>
  <meta charset="utf-8">

  <title>👌👌🏻👌🏼👌🏽👌🏾👌🏿</title>
  <meta name="description" content="Jaaaa">
  <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1, maximum-scale=1.0, user-scalable=no">
  <link rel="stylesheet" type="text/css" href="reset.css">

  <link rel="icon" type="image/png" href="favicon.png">
  <link rel="apple-touch-icon" href="favicon.png">
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-177518266-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-177518266-1');
  </script>

  <style>
      #image-wrapper {
          position: relative;
          display: inline-block;

          transition: all 1s ease;
          left: -150%;
          top: 54%;

          /* background-color: black; */
      }

      html {
        background-color: black;


        user-select: none;
        -moz-user-select: none;
        -khtml-user-select: none;
        -webkit-user-select: none;
        -o-user-select: none;

        overflow: hidden;
      }

      #neutralize-circle {
        position: absolute;
        width: 20%;
        height: 24%;
        left: 43%;
        top: 34%;
        /* border: 1px solid blue; */
      }
  </style>
</head>
<body>
    <div id="you-congrats" style="display: none; color: white; width: 100%; height: 100%; z-index: 4; position: absolute; align-items: center; justify-content: center; flex-direction: row;">
      <div style="font-size: 40px;">You won, good job</div>
    </div>

    <div id="me-congrats" style="display: none; color: white; width: 100%; height: 100%; z-index: 4; position: absolute; align-items: center; justify-content: center; flex-direction: row;">
      <div style="font-size: 40px;">HaHa, I won better luck next time</div>
    </div>

    <div id="score-container" style="display: flex; justify-content: center; align-items: baseline;">
      <div style="color: white; margin-right: 30px; text-align: center; margin-top: 10px;"><span style="font-size: 14px;">you: </span><span id="you" style="font-size: 18px;">0</span><span>/10</span></div>
      <div style="color: white; font-size: 17px; margin-top: 10px;"><span style="font-size: 14px;">me: </span><span id="me" style="font-size: 18px;">0</span><span>/10</span></div>
    </div>

    <div style="position: relative; height: 100%;">
      <div id="image-wrapper">
        <img id="image" src="circle.jpg">
        <div id="neutralize-circle" ontouchstart="handleNeutralize()" onmousedown="handleNeutralize()"></div>
      </div>
    </div>
  
    <script>
        const wrapper = document.getElementById('wrapper');
        
        const image = document.getElementById('image');
        const imageWrapper = document.getElementById('image-wrapper');
        
        const neutralizeCircle = document.getElementById('neutralize-circle');

        const you = document.getElementById('you');
        const me = document.getElementById('me');

        const youCongrats = document.getElementById('you-congrats');
        const meCongrats = document.getElementById('me-congrats');

        const screenWidth = document.body.clientWidth;
        const screenHeight = document.body.clientHeight;

        if (screenWidth < screenHeight) {          
          imageWrapper.style.width = '45%';
          image.style.width = '100%';
        } else {          
          imageWrapper.style.height = '45%';
          image.style.height = '100%';
        }

        let neutralize = false;

        const handleNeutralize = (event) => {
          if (neutralize === false) { 
            youScore += 1;
            
            you.innerHTML = youScore;
            neutralize = true;

            switch (youScore) {
                case 1:
                  reactionTime -= subtraction;
                  break;
                case 2:
                  reactionTime -= subtraction;
                  break;
                case 3:
                  reactionTime -= subtraction;
                  break;
                case 4:
                  reactionTime -= subtraction;
                  break;
                case 5:
                  reactionTime -= subtraction;
                  break;
                case 6:
                  reactionTime -= subtraction;
                  break;
                case 7:
                  reactionTime -= 50;
                  break;
                case 8:
                  reactionTime -= 50;
                  break;
                case 9:
                  reactionTime -= 50;
                  break;
              }
          }
          event.preventDefault();
        };

        let firstTime = true;
        const subtraction = 100;
        let reactionTime = 1650;
        const sizeOfHand = 35;

        let youScore = 0;
        let meScore = 0;

        document.getElementById('image').setAttribute('draggable', false);


        const mainLoop = setInterval(() => requestAnimationFrame(() => {
          imageWrapper.style.left = getRandomInt(100 - sizeOfHand) + '%';
          imageWrapper.style.top = getRandomInt(100 - sizeOfHand) + '%';
        
          setTimeout(() => {
            requestAnimationFrame(() => {
              if (getRandomInt(10) % 2 === 0) {
                imageWrapper.style.left = '-150%';
              } else {
                imageWrapper.style.left = '150%';
              }

              if (getRandomInt(10) % 2 === 0) {
                imageWrapper.style.top = getRandomInt(150) + '%';
              } else {
                imageWrapper.style.top = '-' + getRandomInt(150) + '%';
              }
              
              setTimeout(() => {
                if (neutralize === false) {
                  meScore += 1;
                  me.innerHTML = meScore;
                }

              if (youScore === 10) {
                youCongrats.style.display = 'flex';
                clearInterval(mainLoop);
              }

              if (meScore === 10) {
                meCongrats.style.display = 'flex';
                clearInterval(mainLoop);
              }

                // Reset flag when out of screen
                neutralize = false;
              }, 200);
            })
          }, reactionTime)

        }), 6000);

        const getRandomInt = (max) => Math.floor(Math.random() * Math.floor(max));

        function touchHandler(event) {
          if(event.touches.length > 1){
              //the event is multi-touch
              //you can then prevent the behavior
              event.preventDefault()
          }
        };

        window.addEventListener("touchstart", touchHandler, false);

        neutralizeCircle.addEventListener('touchstart', function(e){e.stopPropagation()}, false);
    </script>
</body>
</html>
